# =============================================================================
# AI Generator - Environment Configuration
# =============================================================================
# Скопируйте этот файл в .env и заполните все значения
# НЕ коммитьте .env файл в Git!
# =============================================================================

# -----------------------------------------------------------------------------
# Окружение и режим работы
# -----------------------------------------------------------------------------
ENVIRONMENT=development  # development, production, testing
DEBUG=True               # False для production

# -----------------------------------------------------------------------------
# Backend FastAPI
# -----------------------------------------------------------------------------
SECRET_KEY=your_random_secret_key_here_change_in_production
API_V1_PREFIX=/api/v1
PROJECT_NAME=AI Generator
BACKEND_URL=http://localhost:8000  # Публичный URL backend (для генерации абсолютных ссылок на /uploads). В production обязательно https://<домен>

# -----------------------------------------------------------------------------
# База данных PostgreSQL
# -----------------------------------------------------------------------------
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=ai_image_bot
POSTGRES_HOST=localhost  # В Docker: postgres
POSTGRES_PORT=5432
DATABASE_URL=postgresql+asyncpg://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# -----------------------------------------------------------------------------
# Redis (для Celery)
# -----------------------------------------------------------------------------
REDIS_URL=redis://localhost:6379/0  # В Docker: redis://redis:6379/0

# -----------------------------------------------------------------------------
# External APIs
# -----------------------------------------------------------------------------

# OpenRouter API (GPT-4.1 Mini для улучшения промптов)
OPENROUTER_API_KEY=your_openrouter_api_key_here
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
OPENROUTER_MODEL=anthropic/claude-3-haiku-20240307

# GrsAI Nano Banana Pro API (Primary AI image generation service)
GRS_AI_API_KEY=your_grsai_api_key_here
GRS_AI_BASE_URL=https://grsaiapi.com
GRS_AI_TIMEOUT=300
GRS_AI_POLL_INTERVAL=5
GRS_AI_MAX_POLLS=60
GRS_AI_MODEL=nano-banana-pro
GRS_AI_FALLBACK_MODEL=nano-banana-pro-cl
GRS_AI_IMAGE_SIZE=1K

# kie.ai Nano Banana Pro API (Fallback)
USE_KIE_AI=false  # Использовать kie.ai как fallback
KIE_AI_API_KEY=your_kie_ai_api_key_here
KIE_AI_BASE_URL=https://api.kie.ai/v1
KIE_AI_TIMEOUT=300  # Timeout в секундах
KIE_AI_POLL_INTERVAL=5  # Интервал polling статуса в секундах

# -----------------------------------------------------------------------------
# Frontend URL
# -----------------------------------------------------------------------------
# URL фронтенда для CORS и return_url в платежах
# Development: http://localhost:5173
# Production: https://your-domain.com
FRONTEND_URL=http://localhost:5173  # В production: https://<домен>

# -----------------------------------------------------------------------------
# ЮKassa (платежная система)
# -----------------------------------------------------------------------------
YUKASSA_SHOP_ID=your_shop_id_here
YUKASSA_SECRET_KEY=your_secret_key_here
YUKASSA_WEBHOOK_SECRET=your_webhook_secret_here
PAYMENT_MOCK_MODE=true  # false для production

# -----------------------------------------------------------------------------
# JWT Authentication
# -----------------------------------------------------------------------------
JWT_SECRET_KEY=your_jwt_secret_key_here_change_in_production
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=1440  # 24 часа

# -----------------------------------------------------------------------------
# Admin Panel
# -----------------------------------------------------------------------------
ADMIN_SECRET_KEY=your_admin_secret_key_here

# -----------------------------------------------------------------------------
# File Storage
# -----------------------------------------------------------------------------
UPLOAD_DIR=./uploads
MAX_FILE_SIZE_MB=10
MAX_VIDEO_FILE_SIZE_MB=200
ALLOWED_EXTENSIONS=jpg,jpeg,png,webp,heic,heif,mpo
PHOTO_RETENTION_HOURS=24           # Удаление фото примерки через 24 часа
CHAT_HISTORY_RETENTION_DAYS=30     # Удаление старых чат-сессий через 30 дней

# -----------------------------------------------------------------------------
# Email / SMTP (верификация и сброс пароля)
# -----------------------------------------------------------------------------
EMAIL_VERIFICATION_ENABLED=true
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_USE_TLS=true
EMAIL_FROM=
EMAIL_FROM_NAME=AI Generator
EMAIL_VERIFICATION_TOKEN_TTL_MIN=30
PASSWORD_RESET_TOKEN_TTL_MIN=30

# -----------------------------------------------------------------------------
# Monetization Settings
# -----------------------------------------------------------------------------
FREEMIUM_ACTIONS_PER_MONTH=10
FREEMIUM_WATERMARK_TEXT=AI Generator

# Налоги и комиссии
NPD_TAX_RATE=0.04                  # НПД 4%
YUKASSA_COMMISSION_RATE=0.028      # ЮKassa 2.8%

# -----------------------------------------------------------------------------
# Rate Limiting / Anti-abuse
# -----------------------------------------------------------------------------
RATE_LIMIT_PER_MINUTE=10
REGISTRATION_LIMIT_PER_IP_PER_DAY=3
FREE_ACTIONS_PER_MONTH=10
REQUIRE_PHONE_VERIFICATION=true
ENABLE_DEVICE_FINGERPRINT=true

# -----------------------------------------------------------------------------
# Sentry Error Tracking (опционально)
# -----------------------------------------------------------------------------
SENTRY_DSN=

# -----------------------------------------------------------------------------
# Vite Frontend Variables (для docker-compose build args)
# -----------------------------------------------------------------------------
VITE_API_BASE_URL=http://localhost:8000  # В production: https://<домен>
VITE_APP_NAME=AI Generator
VITE_ENV=development
