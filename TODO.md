# TODO ‚Äî –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ AI Image Generator

–≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —ç—Ç–∞–ø–∞–º, –∑–∞–¥–∞—á–∞–º –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º.

---

## –õ–µ–≥–µ–Ω–¥–∞ —Å—Ç–∞—Ç—É—Å–æ–≤

- ‚úÖ **Completed** ‚Äî –í—ã–ø–æ–ª–Ω–µ–Ω–æ
- üöß **In Progress** ‚Äî –í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- ‚è≥ **Pending** ‚Äî –û–∂–∏–¥–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- üî¥ **Blocked** ‚Äî –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (—Ç—Ä–µ–±—É–µ—Ç –¥—Ä—É–≥–∏—Ö –∑–∞–¥–∞—á)
- ‚ö° **High Priority** ‚Äî –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
- üîµ **Medium Priority** ‚Äî –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
- ‚ö™ **Low Priority** ‚Äî –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

---

## –≠—Ç–∞–ø 0: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ ‚úÖ

### Backend
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (backend, frontend, docs)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω FastAPI —Å –±–∞–∑–æ–≤—ã–º app/main.py
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω SQLAlchemy (async) + PostgreSQL
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã –º–æ–¥–µ–ª–∏ –ë–î: User, Generation, ChatHistory, Payment, Referral
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω Alembic –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω OpenRouter –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (kie.ai –æ—Ç–∫–ª—é—á—ë–Ω)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã Docker –∏ docker-compose
- ‚úÖ –°–æ–∑–¥–∞–Ω .env.example –∏ requirements.txt

### Frontend
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ React + TypeScript + Vite
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω Tailwind CSS
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Zustand, Axios –∏ –¥—Ä.)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω ESLint –∏ TypeScript –∫–æ–Ω—Ñ–∏–≥
- ‚úÖ –°–æ–∑–¥–∞–Ω Dockerfile –∏ nginx.conf

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ Backend dev –æ–∫—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ (PostgreSQL, Uvicorn)
- ‚úÖ Frontend dev –æ–∫—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ (Vite dev server)
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –∏–Ω–¥–µ–∫—Å—ã –ë–î

---


## –≠—Ç–∞–ø 3: API –¥–ª—è –ø—Ä–∏–º–µ—Ä–∫–∏ –æ–¥–µ–∂–¥—ã (Backend) ‚úÖ ‚ö°

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è #1

### 3.1. Pydantic —Å—Ö–µ–º—ã –¥–ª—è –ø—Ä–∏–º–µ—Ä–∫–∏
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/schemas/fitting.py`
  - [x] `FittingUploadResponse` (file_id: UUID, url: str)
  - [x] `FittingRequest` (user_photo_id: UUID, item_photo_id: UUID, accessory_zone: str | None)
  - [x] `FittingResponse` (task_id: str, status: str)
  - [x] `FittingResult` (task_id: str, status: str, image_url: str | None, error: str | None)
  - [x] `FittingStatusResponse` (task_id: str, status: str, progress: int | None)
  - [x] `FittingError` (detail: str, error_code: str | None)

### 3.2. –°–µ—Ä–≤–∏—Å –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/services/file_validator.py`
  - [x] –§—É–Ω–∫—Ü–∏—è `validate_image_file(file: UploadFile) -> bool`
  - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ MIME-—Ç–∏–ø–∞ (image/jpeg, image/png)
  - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ (‚â§5MB)
  - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ magic bytes (—Å–∏–≥–Ω–∞—Ç—É—Ä—ã —Ñ–∞–π–ª–æ–≤)
  - [x] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ imghdr
  - [x] –§—É–Ω–∫—Ü–∏—è `get_file_extension()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
  - [x] –§—É–Ω–∫—Ü–∏—è `get_image_dimensions()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤

### 3.3. –°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/services/file_storage.py`
  - [x] –§—É–Ω–∫—Ü–∏—è `save_upload_file(file: UploadFile, user_id: int) -> tuple[UUID, str, int]`
  - [x] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è UUID –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
  - [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ UPLOAD_DIR (–∏–∑ .env)
  - [x] –í–æ–∑–≤—Ä–∞—Ç UUID, URL –∏ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞
  - [x] –§—É–Ω–∫—Ü–∏—è `save_upload_file_by_content()` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑ –±–∞–π—Ç–æ–≤
  - [x] –§—É–Ω–∫—Ü–∏—è `get_file_by_id()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –ø–æ UUID
  - [x] –§—É–Ω–∫—Ü–∏—è `delete_file()` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
  - [x] –§—É–Ω–∫—Ü–∏—è `delete_old_files()` ‚Äî –∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ (Celery periodic task)
  - [x] –§—É–Ω–∫—Ü–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: `get_upload_dir_size()`, `get_upload_dir_file_count()`, `cleanup_upload_dir()`

### 3.4. –°–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—Ä–µ–¥–∏—Ç–∞–º–∏
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/services/credits.py`
  - [x] –§—É–Ω–∫—Ü–∏—è `check_user_can_perform_action()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—è
  - [x] –§—É–Ω–∫—Ü–∏—è `deduct_credits()` ‚Äî —Å–ø–∏—Å–∞–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–æ–≤ (–∫—Ä–µ–¥–∏—Ç—ã, –ø–æ–¥–ø–∏—Å–∫–∞, Freemium)
  - [x] –§—É–Ω–∫—Ü–∏—è `award_credits()` ‚Äî –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–æ–≤ —Å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é
  - [x] –§—É–Ω–∫—Ü–∏—è `award_subscription()` ‚Äî –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏
  - [x] –§—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—á—ë—Ç–∞: `calculate_credits_for_tariff()`, `calculate_price_for_tariff()`
  - [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç—Ä—ë—Ö —Å–ø–æ—Å–æ–±–æ–≤ –æ–ø–ª–∞—Ç—ã

### 3.5. Celery –∑–∞–¥–∞—á–∏
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/tasks/celery_app.py` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Celery
  - [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—Ä–æ–∫–µ—Ä–∞ (Redis) –∏ backend
  - [x] Task routes –¥–ª—è –æ—á–µ—Ä–µ–¥–µ–π (fitting, editing, maintenance)
  - [x] Beat schedule –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á
  - [x] –¢–∞–π–º–∞—É—Ç—ã –∏ retry –ª–æ–≥–∏–∫–∞
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/tasks/fitting.py` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ—Ä–∫–∏
  - [x] –ó–∞–¥–∞—á–∞ `generate_fitting_task()`
  - [x] –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ (—Å —É—á—ë—Ç–æ–º –∑–æ–Ω—ã –∞–∫—Å–µ—Å—Å—É–∞—Ä–∞)
  - [x] Retry –ª–æ–≥–∏–∫–∞ (3 –ø–æ–ø—ã—Ç–∫–∏, exponential backoff)
  - [x] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ Generation –≤ –ë–î (pending ‚Üí processing ‚Üí completed/failed)
  - [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ –¥–ª—è Freemium –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/tasks/maintenance.py` ‚Äî –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏
  - [x] `delete_old_files_task()` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Å—Ç–∞—Ä—à–µ 24—á
  - [x] `reset_freemium_counters_task()` ‚Äî —Å–±—Ä–æ—Å Freemium —Å—á—ë—Ç—á–∏–∫–æ–≤ (30 –¥–Ω–µ–π)
  - [x] `cleanup_old_chat_histories_task()` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —á–∞—Ç-–∏—Å—Ç–æ—Ä–∏–π

### 3.6. API endpoints –¥–ª—è –ø—Ä–∏–º–µ—Ä–∫–∏
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/api/v1/endpoints/fitting.py`
  - [x] `POST /api/v1/fitting/upload` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ (multipart/form-data)
    - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–∞ (MIME, magic bytes, —Ä–∞–∑–º–µ—Ä)
    - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å UUID –∏–º–µ–Ω–µ–º
    - –í–æ–∑–≤—Ä–∞—Ç file_id, URL, size, mime_type
  - [x] `POST /api/v1/fitting/generate` ‚Äî –∑–∞–ø—É—Å–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ (‚â•2 –∫—Ä–µ–¥–∏—Ç–∞ –∏–ª–∏ Freemium)
    - –°–ø–∏—Å–∞–Ω–∏–µ 2 –∫—Ä–µ–¥–∏—Ç–æ–≤
    - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ Generation –≤ –ë–î
    - –ó–∞–ø—É—Å–∫ Celery –∑–∞–¥–∞—á–∏
    - –í–æ–∑–≤—Ä–∞—Ç task_id
  - [x] `GET /api/v1/fitting/status/{task_id}` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
    - –ü–æ–ª—É—á–µ–Ω–∏–µ Generation –ø–æ task_id
    - –í–æ–∑–≤—Ä–∞—Ç status, progress (0-100), message
  - [x] `GET /api/v1/fitting/result/{task_id}` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    - –í–æ–∑–≤—Ä–∞—Ç image_url –ø—Ä–∏ status=completed
    - –í–æ–∑–≤—Ä–∞—Ç error_message –ø—Ä–∏ status=failed
    - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–æ–¥—è–Ω–æ–º –∑–Ω–∞–∫–µ –∏ –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω—ã—Ö –∫—Ä–µ–¥–∏—Ç–∞—Ö
  - [x] `GET /api/v1/fitting/history` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–π (—Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π)

### 3.7. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ main.py
- ‚úÖ –ü–æ–¥–∫–ª—é—á–∏—Ç—å fitting router
  - [x] Import fitting endpoints
  - [x] –î–æ–±–∞–≤–∏—Ç—å router —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `/api/v1/fitting`
  - [x] –¢–µ–≥ "fitting" –¥–ª—è Swagger UI

### 3.8. WebSocket –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- ‚è≥ –°–æ–∑–¥–∞—Ç—å `app/api/v1/ws/fitting.py` (–û–¢–õ–û–ñ–ï–ù–û - –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
  - [ ] WebSocket endpoint `/ws/fitting/{task_id}`
  - [ ] –û—Ç–ø—Ä–∞–≤–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–∞ –≤ real-time
  - [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Redis Pub/Sub –¥–ª—è broadcasting

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (‚è≥)
- ‚è≥ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è `file_validator`, `file_storage`, `credits`
- ‚è≥ Integration —Ç–µ—Å—Ç—ã –¥–ª—è API endpoints
- ‚è≥ E2E —Ç–µ—Å—Ç: –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ ‚Üí –≥–µ–Ω–µ—Ä–∞—Ü–∏—è ‚Üí –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

### –ò—Ç–æ–≥–æ –ø–æ –≠—Ç–∞–ø—É 3
- ‚úÖ **Backend –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** (8 –º–æ–¥—É–ª–µ–π —Å–æ–∑–¥–∞–Ω–æ)
- ‚úÖ **–°–æ–∑–¥–∞–Ω–æ 3 —Å–µ—Ä–≤–∏—Å–∞**: file_storage, credits, file_validator
- ‚úÖ **–°–æ–∑–¥–∞–Ω–æ 3 Celery –∑–∞–¥–∞—á–∏**: fitting, maintenance, celery_app
- ‚úÖ **–°–æ–∑–¥–∞–Ω–æ 5 API endpoints**: upload, generate, status, result, history
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ main.py**: fitting router –ø–æ–¥–∫–ª—é—á—ë–Ω
- üîç **–î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** Backend API –Ω–∞ http://localhost:8000/docs
- ‚è≥ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** Unit –∏ E2E —Ç–µ—Å—Ç—ã –æ–∂–∏–¥–∞—é—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚è≥ **WebSocket:** –û—Ç–ª–æ–∂–µ–Ω (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å polling)
- üÜï **–û–ë–ù–û–í–õ–ï–ù–û v0.16.0:** –î–æ–±–∞–≤–ª–µ–Ω—ã AI-–ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –∑–æ–Ω "face" –∏ "body" –≤ FITTING_PROMPTS

**Backend –ø—Ä–∏–º–µ—Ä–∫–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω! –ì–æ—Ç–æ–≤–æ –∫ frontend –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (–≠—Ç–∞–ø 4).**

---

## –≠—Ç–∞–ø: –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è VK ID (OAuth 2.1, PKCE) ‚ö°

**–¶–µ–ª—å:** –ø–µ—Ä–µ–π—Ç–∏ —Å —Ç–µ–∫—É—â–µ–≥–æ silent-token –ø–æ—Ç–æ–∫–∞ –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π OAuth 2.1 + PKCE, —É—Å–∏–ª–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ VK ID.

### –ó–∞–¥–∞—á–∏
- ‚úÖ –ü—Ä–∏–≤–µ—Å—Ç–∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∫ –µ–¥–∏–Ω–æ–º—É –Ω–∞–±–æ—Ä—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö: `VK_APP_ID`, `VK_CLIENT_SECRET` (–æ–±–Ω–æ–≤–∏—Ç—å –≥–∞–π–¥—ã –∏ .env.example).
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É VK ID SDK –Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é (One Tap / authorize) –≤–º–µ—Å—Ç–æ `@<3.0.0`.
- üöß –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å PKCE-—Ñ–ª–æ—É –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è `code_verifier`, `code_challenge`, `state`, `nonce`; —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `https://id.vk.ru/authorize`.
- üöß –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±–º–µ–Ω `code` ‚Üí `access_token/refresh_token/id_token` –Ω–∞ –±—ç–∫–µ–Ω–¥–µ —á–µ—Ä–µ–∑ `POST https://id.vk.ru/oauth2/auth` —Å `code_verifier`; –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å `state/nonce`.
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∏ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å `id_token` (–ø–æ–¥–ø–∏—Å—å, `aud`, `iss`, `exp`, `nonce`) –∏ –ø—Ä–∏–≤—è–∑—ã–≤–∞—Ç—å —Å–µ—Å—Å–∏—é –∫ `device_id/uuid`.
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ö–µ–º—ã –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Ç–æ–∫–µ–Ω–æ–≤: —Ö—Ä–∞–Ω–∏—Ç—å `refresh_token` —Å–µ—Ä–≤–µ—Ä-—Å–∞–π–¥, –≤ –±—Ä–∞—É–∑–µ—Ä–µ ‚Äî —Ç–æ–ª—å–∫–æ –Ω–∞—à JWT.
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `docs/VK_OAUTH_SETUP.md` –ø–æ–¥ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π PKCE-—Ñ–ª–æ—É; —É–±—Ä–∞—Ç—å –≤–≤–æ–¥—è—â–∏–π –≤ –∑–∞–±–ª—É–∂–¥–µ–Ω–∏–µ `VK_SERVICE_KEY`.
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å rate limiting –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –¥–ª—è `/auth-web/vk/pkce`.

---

## –≠—Ç–∞–ø 4: UI –¥–ª—è –ø—Ä–∏–º–µ—Ä–∫–∏ (Frontend) ‚úÖ ‚ö°

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è #1

### 4.1. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è step-wizard
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/fitting/FittingWizard.tsx`
  - [x] –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —à–∞–≥–∞–º–∏ (–ù–∞–∑–∞–¥/–î–∞–ª–µ–µ)
  - [x] –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (1/3, 2/3, 3/3)
  - [x] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —à–∞–≥–æ–≤ (user_photo ‚Üí item_photo ‚Üí zone ‚Üí generating ‚Üí result)
  - [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/fitting/Step1UserPhoto.tsx`
  - [x] Drag & drop –∑–æ–Ω–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - [x] –ü—Ä–µ–≤—å—é –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Ñ–æ—Ç–æ
  - [x] –ö–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ" (–∞–∫—Ç–∏–≤–Ω–∞ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏)
  - [x] –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ (JPEG/PNG, max 5MB)
  - [x] Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ/–æ—à–∏–±–∫–µ
  - [x] –°–æ–≤–µ—Ç—ã –¥–ª—è –ª—É—á—à–µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/fitting/Step2ItemPhoto.tsx`
  - [x] Drag & drop –∑–æ–Ω–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ–¥–µ–∂–¥—ã/–∞–∫—Å–µ—Å—Å—É–∞—Ä–∞
  - [x] –ü—Ä–µ–≤—å—é –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Ñ–æ—Ç–æ
  - [x] –ù–∞–≤–∏–≥–∞—Ü–∏—è –ù–∞–∑–∞–¥/–î–∞–ª–µ–µ
  - [x] –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–∞—Ö
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/fitting/Step3Zone.tsx`
  - [x] 6 –∫–Ω–æ–ø–æ–∫ –≤—ã–±–æ—Ä–∞ –∑–æ–Ω—ã: –ì–æ–ª–æ–≤–∞, –õ–∏—Ü–æ, –®–µ—è, –†—É–∫–∏, –ù–æ–≥–∏, –í—Å—ë —Ç–µ–ª–æ
  - [x] –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∑–æ–Ω—ã
  - [x] –ö–Ω–æ–ø–∫–∞ "–ü—Ä–∏–º–µ—Ä–∏—Ç—å" (–∑–∞–ø—É—Å–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏)
  - [x] –ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å" –¥–ª—è –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
  - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –∫—Ä–µ–¥–∏—Ç–æ–≤
  - [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –∏ –ø–æ–¥–ø–∏—Å–∫–∏
  - [x] –û–ë–ù–û–í–õ–ï–ù–û v0.16.0: –î–æ–±–∞–≤–ª–µ–Ω—ã –∑–æ–Ω—ã "–õ–∏—Ü–æ" (üëì –æ—á–∫–∏/–º–∞—Å–∫–∏) –∏ "–í—Å—ë —Ç–µ–ª–æ" (üëî –æ–¥–µ–∂–¥–∞)

### 4.2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/common/FileUpload.tsx`
  - [x] React Dropzone –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
  - [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (—Ç–∏–ø, —Ä–∞–∑–º–µ—Ä)
  - [x] –ü—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
  - [x] –ò–Ω–¥–∏–∫–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
  - [x] Drag & drop —Å –≤–∏–∑—É–∞–ª—å–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑—å—é
  - [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### 4.3. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/fitting/GenerationProgress.tsx`
  - [x] –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä (Framer Motion)
  - [x] –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ ("–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤–∞—à –æ–±—Ä–∞–∑...")
  - [x] –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ –ø—Ä–æ–≥—Ä–µ—Å—Å—É (0-20%, 20-40%, etc.)
  - [x] –í—Ä–∞—â–∞—é—â–∞—è—Å—è –∏–∫–æ–Ω–∫–∞
  - [x] –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (dots)
  - [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω polling –≤–º–µ—Å—Ç–æ WebSocket

### 4.4. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø—Ä–∏–º–µ—Ä–∫–∏
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/fitting/FittingResult.tsx`
  - [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
  - [x] –ö–Ω–æ–ø–∫–∏: –°–∫–∞—á–∞—Ç—å, –ü–æ–¥–µ–ª–∏—Ç—å—Å—è, –ù–æ–≤–∞—è –ø—Ä–∏–º–µ—Ä–∫–∞
  - [x] Zoom/full-screen –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
  - [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
  - [x] –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä Freemium –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫–∞
  - [x] –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω—ã—Ö –∫—Ä–µ–¥–∏—Ç–∞—Ö

### 4.5. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏–º–µ—Ä–∫–∏
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/pages/FittingPage.tsx`
  - [x] –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ FittingWizard
  - [x] AuthGuard –¥–ª—è –∑–∞—â–∏—Ç—ã –¥–æ—Å—Ç—É–ø–∞
  - [x] Sticky header —Å –±–∞–ª–∞–Ω—Å–æ–º –∫—Ä–µ–¥–∏—Ç–æ–≤
  - [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –≤—Ö–æ–¥–µ

### 4.6. API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/api/fitting.ts`
  - [x] `uploadPhoto(file: File) -> Promise<FittingUploadResponse>`
  - [x] `generateFitting(request: FittingRequest) -> Promise<FittingResponse>`
  - [x] `getFittingStatus(taskId: string) -> Promise<FittingStatusResponse>`
  - [x] `getFittingResult(taskId: string) -> Promise<FittingResult>`
  - [x] `getFittingHistory(page, pageSize) -> Promise<GenerationHistoryResponse>`
  - [x] `pollFittingStatus()` ‚Äî polling —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

### 4.7. Zustand store –¥–ª—è –ø—Ä–∏–º–µ—Ä–∫–∏
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/store/fittingStore.ts`
  - [x] State: `userPhoto`, `itemPhoto`, `accessoryZone`, `taskId`, `result`, `status`, `progress`
  - [x] Actions: `uploadUserPhoto()`, `uploadItemPhoto()`, `setAccessoryZone()`, `startGeneration()`, `reset()`
  - [x] –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
  - [x] –°–æ–∑–¥–∞–Ω–∏–µ preview –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  - [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
  - [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 4.8. TypeScript —Ç–∏–ø—ã
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/types/fitting.ts`
  - [x] –ü–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö API responses
  - [x] Enum —Ç–∏–ø—ã (AccessoryZone, GenerationStatus)
  - [x] –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ç–∏–ø—ã (UploadedFile)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (‚è≥)
- ‚è≥ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (React Testing Library)
- ‚è≥ E2E —Ç–µ—Å—Ç: –ø–æ–ª–Ω—ã–π flow –ø—Ä–∏–º–µ—Ä–∫–∏ (–∑–∞–≥—Ä—É–∑–∫–∞ ‚Üí –≥–µ–Ω–µ—Ä–∞—Ü–∏—è ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç)

### –ò—Ç–æ–≥–æ –ø–æ –≠—Ç–∞–ø—É 4
- ‚úÖ **Frontend –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** (11 –º–æ–¥—É–ª–µ–π —Å–æ–∑–¥–∞–Ω–æ)
- ‚úÖ **–°–æ–∑–¥–∞–Ω–æ 8 UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤**: FileUpload, Step1-3, GenerationProgress, FittingResult, FittingWizard
- ‚úÖ **–°–æ–∑–¥–∞–Ω 1 API –∫–ª–∏–µ–Ω—Ç**: fitting.ts —Å polling —Ñ—É–Ω–∫—Ü–∏–µ–π
- ‚úÖ **–°–æ–∑–¥–∞–Ω 1 Zustand store**: fittingStore.ts
- ‚úÖ **–°–æ–∑–¥–∞–Ω–∞ 1 —Å—Ç—Ä–∞–Ω–∏—Ü–∞**: FittingPage.tsx
- üîç **–î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã
- ‚è≥ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** Unit –∏ E2E —Ç–µ—Å—Ç—ã –æ–∂–∏–¥–∞—é—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- üÜï **–û–ë–ù–û–í–õ–ï–ù–û v0.16.0:** Step3Zone —Ä–∞—Å—à–∏—Ä–µ–Ω –¥–æ 6 –∑–æ–Ω (–¥–æ–±–∞–≤–ª–µ–Ω—ã "–õ–∏—Ü–æ" –∏ "–í—Å—ë —Ç–µ–ª–æ")

**–≠—Ç–∞–ø 4 –∑–∞–≤–µ—Ä—à—ë–Ω! UI –¥–ª—è –ø—Ä–∏–º–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å backend. –°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø: –≠—Ç–∞–ø 5 (API –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π).**

---

## –≠—Ç–∞–ø 5: API –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (Backend) ‚úÖ üîµ

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è #2

### 5.1. Pydantic —Å—Ö–µ–º—ã –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/schemas/editing.py`
  - [x] `ChatSessionCreate` (base_image_url: str)
  - [x] `ChatSessionResponse` (session_id: UUID, base_image_url: str)
  - [x] `ChatMessageRequest` (session_id: UUID, message: str)
  - [x] `ChatMessageResponse` (role: str, content: str, prompts: list[str] | None, timestamp: str)
  - [x] `GenerateImageRequest` (session_id: UUID, prompt: str)
  - [x] `GenerateImageResponse` (task_id: str, status: str)
  - [x] `ChatHistoryMessage`, `ChatHistoryResponse`, `ResetSessionResponse`

### 5.2. –°–µ—Ä–≤–∏—Å –¥–ª—è OpenRouter (GPT-4.1 Mini)
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/services/openrouter.py`
  - [x] –§—É–Ω–∫—Ü–∏—è `generate_prompts(user_message: str, chat_history: list[dict]) -> list[str]`
  - [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenRouter API (–º–æ–¥–µ–ª—å: claude-3-haiku-20240307)
  - [x] –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ 3 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
  - [x] –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
  - [x] –ü–æ–¥—Å—á—ë—Ç —Ç–æ–∫–µ–Ω–æ–≤ (input/output) –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
  - [x] Retry –ª–æ–≥–∏–∫–∞ (3 –ø–æ–ø—ã—Ç–∫–∏, exponential backoff)
  - [x] Singleton instance –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 5.3. –°–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–∞—Ç-–∏—Å—Ç–æ—Ä–∏–µ–π
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/services/chat.py`
  - [x] –§—É–Ω–∫—Ü–∏—è `create_chat_session()` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏
  - [x] –§—É–Ω–∫—Ü–∏—è `get_chat_session()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
  - [x] –§—É–Ω–∫—Ü–∏—è `add_message()` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∏—Å—Ç–æ—Ä–∏—é
  - [x] –§—É–Ω–∫—Ü–∏—è `get_last_messages()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö N —Å–æ–æ–±—â–µ–Ω–∏–π
  - [x] –§—É–Ω–∫—Ü–∏—è `get_messages_for_ai()` ‚Äî —Ñ–æ—Ä–º–∞—Ç –¥–ª—è OpenRouter API
  - [x] –§—É–Ω–∫—Ü–∏—è `reset_session()` ‚Äî —Å–±—Ä–æ—Å —á–∞—Ç–∞
  - [x] –§—É–Ω–∫—Ü–∏—è `cleanup_old_chat_histories()` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Å–µ—Å—Å–∏–π (>30 –¥–Ω–µ–π)
  - [x] –§—É–Ω–∫—Ü–∏—è `get_user_active_sessions()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 5.4. Celery –∑–∞–¥–∞—á–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/tasks/editing.py`
  - [x] –ó–∞–¥–∞—á–∞ `generate_editing_task()` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  - [x] –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: generation_id, user_id, session_id, base_image_url, prompt
  - [x] Retry –ª–æ–≥–∏–∫–∞ (3 –ø–æ–ø—ã—Ç–∫–∏, exponential backoff)
  - [x] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ChatHistory (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∫–∞–∫ —Å–æ–æ–±—â–µ–Ω–∏–µ assistant)
  - [x] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ –¥–ª—è Freemium
  - [x] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (10% ‚Üí 30% ‚Üí 50% ‚Üí 80% ‚Üí 100%)

### 5.5. API endpoints –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/api/v1/endpoints/editing.py`
  - [x] `POST /api/v1/editing/upload` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–∞ (JPEG/PNG, max 5MB)
    - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å UUID –∏–º–µ–Ω–µ–º
    - –í–æ–∑–≤—Ä–∞—Ç base_image_url
  - [x] `POST /api/v1/editing/session` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏ —á–∞—Ç–∞
    - –°–æ–∑–¥–∞–Ω–∏–µ ChatHistory –≤ –ë–î
    - –í–æ–∑–≤—Ä–∞—Ç session_id
  - [x] `POST /api/v1/editing/chat` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è AI
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ (‚â•1 –∫—Ä–µ–¥–∏—Ç –∏–ª–∏ Freemium)
    - –°–ø–∏—Å–∞–Ω–∏–µ 1 –∫—Ä–µ–¥–∏—Ç–∞
    - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è user –≤ –∏—Å—Ç–æ—Ä–∏—é
    - –í—ã–∑–æ–≤ OpenRouter –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–º–ø—Ç–æ–≤
    - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ assistant –≤ –∏—Å—Ç–æ—Ä–∏—é
    - –í–æ–∑–≤—Ä–∞—Ç 3 –ø—Ä–æ–º–ø—Ç–æ–≤ (–∫–æ—Ä–æ—Ç–∫–∏–π, —Å—Ä–µ–¥–Ω–∏–π, –¥–µ—Ç–∞–ª—å–Ω—ã–π)
  - [x] `POST /api/v1/editing/generate` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ –ø—Ä–æ–º–ø—Ç—É
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ (‚â•1 –∫—Ä–µ–¥–∏—Ç –∏–ª–∏ Freemium)
    - –°–ø–∏—Å–∞–Ω–∏–µ 1 –∫—Ä–µ–¥–∏—Ç–∞
    - –°–æ–∑–¥–∞–Ω–∏–µ Generation –≤ –ë–î
    - –ó–∞–ø—É—Å–∫ Celery –∑–∞–¥–∞—á–∏
    - –í–æ–∑–≤—Ä–∞—Ç task_id
  - [x] `GET /api/v1/editing/history/{session_id}` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞
    - –í–æ–∑–≤—Ä–∞—Ç –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —Å–µ—Å—Å–∏–∏
    - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ base_image_url, message_count, is_active
  - [x] `DELETE /api/v1/editing/session/{session_id}` ‚Äî —Å–±—Ä–æ—Å —á–∞—Ç–∞
    - –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ is_active = False

### 5.6. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ main.py
- ‚úÖ –ü–æ–¥–∫–ª—é—á–∏—Ç—å editing router
  - [x] Import editing endpoints
  - [x] –î–æ–±–∞–≤–∏—Ç—å router —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `/api/v1/editing`
  - [x] –¢–µ–≥ "editing" –¥–ª—è Swagger UI
  - [x] –î–æ–±–∞–≤–∏—Ç—å cleanup OpenRouter –∫–ª–∏–µ–Ω—Ç–∞ –≤ shutdown

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (‚úÖ –ß–∞—Å—Ç–∏—á–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ)
- ‚úÖ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è OpenRouter –∫–ª–∏–µ–Ω—Ç–∞ (3 —Ç–µ—Å—Ç–∞, –≤—Å–µ –ø—Ä–æ–π–¥–µ–Ω—ã)
- ‚úÖ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è chat —Å–µ—Ä–≤–∏—Å–∞ (2 —Ç–µ—Å—Ç–∞, –≤—Å–µ –ø—Ä–æ–π–¥–µ–Ω—ã)
- ‚úÖ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è ChatHistory –º–æ–¥–µ–ª–∏ (5 —Ç–µ—Å—Ç–æ–≤, –≤—Å–µ –ø—Ä–æ–π–¥–µ–Ω—ã)
- ‚úÖ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è Pydantic —Å—Ö–µ–º (3 —Ç–µ—Å—Ç–∞, –≤—Å–µ –ø—Ä–æ–π–¥–µ–Ω—ã)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (—É—Å–ø–µ—à–Ω–æ)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ endpoints –≤ Swagger UI (6 endpoints –¥–æ—Å—Ç—É–ø–Ω—ã)
- ‚è≥ Integration —Ç–µ—Å—Ç—ã –¥–ª—è API endpoints (—Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É –ë–î)
- ‚è≥ E2E —Ç–µ—Å—Ç: —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏ ‚Üí —á–∞—Ç ‚Üí –≥–µ–Ω–µ—Ä–∞—Ü–∏—è ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—Ç—Ä–µ–±—É–µ—Ç API –∫–ª—é—á–∏)
- ‚úÖ **–ò—Ç–æ–≥–æ: 14/14 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ –∑–∞ 0.82 —Å–µ–∫—É–Ω–¥—ã**

### –ò—Ç–æ–≥–æ –ø–æ –≠—Ç–∞–ø—É 5
- ‚úÖ **Backend –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω** (5 –º–æ–¥—É–ª–µ–π —Å–æ–∑–¥–∞–Ω–æ)
- ‚úÖ **–°–æ–∑–¥–∞–Ω–æ 3 —Å–µ—Ä–≤–∏—Å–∞**: openrouter, chat, editing task
- ‚úÖ **–°–æ–∑–¥–∞–Ω–æ 6 API endpoints**: upload, session, chat, generate, history, delete
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ main.py**: editing router –ø–æ–¥–∫–ª—é—á—ë–Ω
- ‚úÖ **Unit-—Ç–µ—Å—Ç—ã**: 14/14 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
- ‚úÖ **–¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ**: Pydantic —Å—Ö–µ–º—ã, OpenRouter, Chat —Å–µ—Ä–≤–∏—Å, ChatHistory –º–æ–¥–µ–ª—å
- üìö **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** TESTING_RESULTS.md –æ–±–Ω–æ–≤–ª—ë–Ω
- üîç **–î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** Backend API –Ω–∞ http://localhost:8000/docs
- üìÅ **–§–∞–π–ª—ã —Ç–µ—Å—Ç–æ–≤:** backend/tests/test_editing_module.py

**–≠—Ç–∞–ø 5 –∑–∞–≤–µ—Ä—à—ë–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω! Backend —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≥–æ—Ç–æ–≤ –∫ frontend –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (–≠—Ç–∞–ø 6).**

---

## –≠—Ç–∞–ø 6: UI –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (Frontend) ‚úÖ üîµ

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è #2

### 6.1. –ß–∞—Ç-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/editing/ChatWindow.tsx`
  - [x] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π (—Å–∫—Ä–æ–ª–ª–∏–Ω–≥)
  - [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π scroll –≤–Ω–∏–∑ –ø—Ä–∏ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
  - [x] –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –∫–∞–∫ –≤ Google AI Studio
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/editing/ChatMessage.tsx`
  - [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (user/assistant)
  - [x] –†–∞–∑–Ω–∞—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è –¥–ª—è user/assistant
  - [x] Timestamp
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/editing/ImageMessage.tsx`
  - [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —á–∞—Ç–µ
  - [x] –ö–Ω–æ–ø–∫–∏: Zoom, –°–∫–∞—á–∞—Ç—å
  - [x] Lazy loading –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### 6.2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤–≤–æ–¥–∞
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/editing/ChatInput.tsx`
  - [x] Textarea –¥–ª—è –≤–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
  - [x] –ö–Ω–æ–ø–∫–∞ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å"
  - [x] –ò–Ω–¥–∏–∫–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ (disabled –≤–æ –≤—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞)
  - [x] Hotkey: Enter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏

### 6.3. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—ã–±–æ—Ä–∞ –ø—Ä–æ–º–ø—Ç–æ–≤
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/editing/PromptSelector.tsx`
  - [x] 3 –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –ø—Ä–æ–º–ø—Ç–æ–≤ –æ—Ç AI
  - [x] –ö–Ω–æ–ø–∫–∞ "–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å" –¥–ª—è –∫–∞–∂–¥–æ–≥–æ
  - [x] –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–ø—Ç–∞ –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π

### 6.4. –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/pages/EditingPage.tsx`
  - [x] –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ ChatWindow
  - [x] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ state —á–∞—Ç–∞
  - [x] –ö–Ω–æ–ø–∫–∞ "–°–±—Ä–æ—Å —á–∞—Ç–∞" (—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º)
  - [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤)

### 6.5. API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/api/editing.ts`
  - [x] `uploadBaseImage(file: File) -> Promise<FittingUploadResponse>`
  - [x] `createChatSession(request: ChatSessionCreate) -> Promise<ChatSessionResponse>`
  - [x] `sendChatMessage(request: ChatMessageRequest) -> Promise<ChatMessageResponse>`
  - [x] `generateEditedImage(request: GenerateImageRequest) -> Promise<GenerateImageResponse>`
  - [x] `getChatHistory(sessionId: string) -> Promise<ChatHistoryResponse>`
  - [x] `resetChatSession(sessionId: string) -> Promise<ResetSessionResponse>`
  - [x] `pollEditingStatus()` ‚Äî polling —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

### 6.6. Zustand store –¥–ª—è —á–∞—Ç–∞
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/store/chatStore.ts`
  - [x] State: `sessionId`, `baseImage`, `messages`, `isLoading`, `currentPrompts`, `isGenerating`
  - [x] Actions: `uploadAndCreateSession()`, `sendMessage()`, `generateImage()`, `loadHistory()`, `reset()`, `resetSession()`
  - [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ—Å–ª–µ –¥–µ–π—Å—Ç–≤–∏–π

### 6.7. TypeScript —Ç–∏–ø—ã
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/types/editing.ts`
  - [x] –ü–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö API responses
  - [x] Enum —Ç–∏–ø—ã (MessageRole)
  - [x] –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ç–∏–ø—ã (ChatMessage, BaseImageUpload)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (‚è≥)
- ‚è≥ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è —á–∞—Ç-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚è≥ E2E —Ç–µ—Å—Ç: –ø–æ–ª–Ω—ã–π flow —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ò—Ç–æ–≥–æ –ø–æ –≠—Ç–∞–ø—É 6
- ‚úÖ **Frontend –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** (9 –º–æ–¥—É–ª–µ–π —Å–æ–∑–¥–∞–Ω–æ)
- ‚úÖ **–°–æ–∑–¥–∞–Ω–æ 5 UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤**: ChatWindow, ChatMessage, ImageMessage, ChatInput, PromptSelector
- ‚úÖ **–°–æ–∑–¥–∞–Ω 1 API –∫–ª–∏–µ–Ω—Ç**: editing.ts —Å polling —Ñ—É–Ω–∫—Ü–∏–µ–π
- ‚úÖ **–°–æ–∑–¥–∞–Ω 1 Zustand store**: chatStore.ts
- ‚úÖ **–°–æ–∑–¥–∞–Ω–∞ 1 —Å—Ç—Ä–∞–Ω–∏—Ü–∞**: EditingPage.tsx
- ‚úÖ **–°–æ–∑–¥–∞–Ω 1 —Ñ–∞–π–ª —Ç–∏–ø–æ–≤**: editing.ts
- üîç **–î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å backend
- ‚è≥ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** Unit –∏ E2E —Ç–µ—Å—Ç—ã –æ–∂–∏–¥–∞—é—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–≠—Ç–∞–ø 6 –∑–∞–≤–µ—Ä—à—ë–Ω! UI –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≥–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é. –°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø: –≠—Ç–∞–ø 7 (–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –∏ –ø–ª–∞—Ç–µ–∂–∏).**

---

## –≠—Ç–∞–ø 7: –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –∏ –ø–ª–∞—Ç–µ–∂–∏ (Backend) ‚úÖ üîµ

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π-–í—ã—Å–æ–∫–∏–π

### 7.1. Pydantic —Å—Ö–µ–º—ã –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/schemas/payment.py`
  - [x] `PaymentCreateRequest` (payment_type: "subscription" | "credits", subscription_type: str | None, credits_amount: int | None)
  - [x] `PaymentCreateResponse` (payment_id: str, confirmation_url: str)
  - [x] `WebhookPayload` (event: str, object: dict)
  - [x] `PaymentHistoryItem`, `PaymentHistoryResponse` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
  - [x] `TariffInfo`, `TariffsListResponse` ‚Äî —Å–ø–∏—Å–æ–∫ —Ç–∞—Ä–∏—Ñ–æ–≤
  - [x] `PaymentStatusResponse` ‚Äî —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞

### 7.2. –°–µ—Ä–≤–∏—Å –¥–ª—è –ÆKassa
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/services/yukassa.py`
  - [x] –ö–ª–∞—Å—Å `YuKassaClient` ‚Äî async –∫–ª–∏–µ–Ω—Ç —Å retry –ª–æ–≥–∏–∫–æ–π
  - [x] –§—É–Ω–∫—Ü–∏—è `create_payment()` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ —á–µ—Ä–µ–∑ API
  - [x] –§—É–Ω–∫—Ü–∏—è `get_payment_info()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–ª–∞—Ç–µ–∂–µ
  - [x] –§—É–Ω–∫—Ü–∏—è `verify_webhook_signature()` ‚Äî –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è HMAC SHA-256
  - [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Shop ID –∏ Secret Key –∏–∑ .env
  - [x] Singleton instance (`get_yukassa_client()`)
  - [x] Context manager support

### 7.3. –õ–æ–≥–∏–∫–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∫—Ä–µ–¥–∏—Ç–æ–≤/–ø–æ–¥–ø–∏—Å–æ–∫
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/services/billing.py`
  - [x] –§—É–Ω–∫—Ü–∏—è `award_credits()` ‚Äî –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–æ–≤ —Å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é
  - [x] –§—É–Ω–∫—Ü–∏—è `award_subscription()` ‚Äî –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏ —Å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é
  - [x] –§—É–Ω–∫—Ü–∏—è `calculate_credits_for_tariff()` ‚Äî —Ä–∞—Å—á—ë—Ç –∫—Ä–µ–¥–∏—Ç–æ–≤ –ø–æ —Ç–∞—Ä–∏—Ñ—É
  - [x] –§—É–Ω–∫—Ü–∏—è `calculate_price_for_tariff()` ‚Äî —Ä–∞—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ç–∞—Ä–∏—Ñ–∞
  - [x] –§—É–Ω–∫—Ü–∏—è `get_all_tariffs()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤
  - [x] –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ç–∞—Ä–∏—Ñ–æ–≤: `SUBSCRIPTION_TARIFFS`, `CREDITS_PACKAGES`
  - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ idempotency_key
  - [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ç–∞–±–ª–∏—Ü—É Payments

### 7.4. –†–∞—Å—á—ë—Ç –Ω–∞–ª–æ–≥–æ–≤ –∏ –∫–æ–º–∏—Å—Å–∏–π
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/utils/tax.py`
  - [x] –§—É–Ω–∫—Ü–∏—è `calculate_npd_tax()` ‚Äî —Ä–∞—Å—á—ë—Ç –ù–ü–î (4%)
  - [x] –§—É–Ω–∫—Ü–∏—è `calculate_yukassa_commission()` ‚Äî —Ä–∞—Å—á—ë—Ç –∫–æ–º–∏—Å—Å–∏–∏ (2.8%)
  - [x] –§—É–Ω–∫—Ü–∏—è `calculate_total_deductions()` ‚Äî –æ–±—â–∞—è —Å—É–º–º–∞ –≤—ã—á–µ—Ç–æ–≤
  - [x] –§—É–Ω–∫—Ü–∏—è `calculate_net_amount()` ‚Äî —á–∏—Å—Ç–∞—è —Å—É–º–º–∞ –ø–æ—Å–ª–µ –≤—ã—á–µ—Ç–æ–≤
  - [x] –§—É–Ω–∫—Ü–∏—è `calculate_gross_amount()` ‚Äî –æ–±—Ä–∞—Ç–Ω—ã–π —Ä–∞—Å—á—ë—Ç
  - [x] –§—É–Ω–∫—Ü–∏—è `format_tax_breakdown()` ‚Äî –ø–æ–ª–Ω–∞—è —Ä–∞–∑–±–∏–≤–∫–∞ —Å—É–º–º—ã

### 7.5. API endpoints –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/api/v1/endpoints/payments.py`
  - [x] `POST /api/v1/payments/create` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
    - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∞—Ä–∏—Ñ–∞
    - –†–∞—Å—á—ë—Ç —Å—É–º–º—ã –ø–æ —Ç–∞—Ä–∏—Ñ—É
    - –°–æ–∑–¥–∞–Ω–∏–µ Payment –≤ –ë–î
    - –í—ã–∑–æ–≤ –ÆKassa API —Å metadata
    - –í–æ–∑–≤—Ä–∞—Ç confirmation_url –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
  - [x] `POST /api/v1/payments/webhook` ‚Äî webhook –æ—Ç –ÆKassa
    - –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∏ (HMAC SHA-256)
    - –û–±—Ä–∞–±–æ—Ç–∫–∞ event: "payment.succeeded", "payment.canceled"
    - –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–æ–≤/–ø–æ–¥–ø–∏—Å–∫–∏ —á–µ—Ä–µ–∑ billing —Å–µ—Ä–≤–∏—Å
    - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Payment –≤ –ë–î
    - –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
  - [x] `GET /api/v1/payments/history` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π)
  - [x] `GET /api/v1/payments/tariffs` ‚Äî —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤
  - [x] `GET /api/v1/payments/status/{payment_id}` ‚Äî —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞

### 7.6. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ main.py
- ‚úÖ –ü–æ–¥–∫–ª—é—á–∏—Ç—å payments router
  - [x] Import payments endpoints
  - [x] –î–æ–±–∞–≤–∏—Ç—å router —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `/api/v1/payments`
  - [x] –¢–µ–≥ "payments" –¥–ª—è Swagger UI
  - [x] –î–æ–±–∞–≤–∏—Ç—å cleanup YuKassa –∫–ª–∏–µ–Ω—Ç–∞ –≤ shutdown
  - [x] –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é API –¥–æ 0.7.0

### 7.7. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `app/core/config.py`
  - [x] –î–æ–±–∞–≤–ª–µ–Ω `FRONTEND_URL` –¥–ª—è return_url
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `.env.example`
  - [x] –î–æ–±–∞–≤–ª–µ–Ω `FRONTEND_URL`

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (‚è≥)
- ‚è≥ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è –ÆKassa –∫–ª–∏–µ–Ω—Ç–∞
- ‚è≥ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è billing —Å–µ—Ä–≤–∏—Å–∞
- ‚è≥ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è tax —É—Ç–∏–ª–∏—Ç
- ‚è≥ Integration —Ç–µ—Å—Ç—ã –¥–ª—è webhook
- ‚è≥ E2E —Ç–µ—Å—Ç: —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ ‚Üí webhook ‚Üí –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–æ–≤

### –ò—Ç–æ–≥–æ –ø–æ –≠—Ç–∞–ø—É 7
- ‚úÖ **Backend –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** (4 –º–æ–¥—É–ª—è —Å–æ–∑–¥–∞–Ω–æ)
- ‚úÖ **–°–æ–∑–¥–∞–Ω–æ 4 —Å–µ—Ä–≤–∏—Å–∞/—É—Ç–∏–ª–∏—Ç—ã**: yukassa.py, billing.py, tax.py, payments.py
- ‚úÖ **–°–æ–∑–¥–∞–Ω–æ 5 API endpoints**: create, webhook, history, tariffs, status
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ main.py**: payments router –ø–æ–¥–∫–ª—é—á—ë–Ω
- ‚úÖ **Pydantic —Å—Ö–µ–º—ã**: –ø–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
- üîç **–î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** Backend API –Ω–∞ http://localhost:8000/docs
- ‚è≥ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** Unit –∏ Integration —Ç–µ—Å—Ç—ã –æ–∂–∏–¥–∞—é—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–≠—Ç–∞–ø 7 –∑–∞–≤–µ—Ä—à—ë–Ω! Backend –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏ –≥–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å frontend (–≠—Ç–∞–ø 8).**

---

## –≠—Ç–∞–ø 8: UI –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π –∏ –ø—Ä–æ—Ñ–∏–ª—è (Frontend) ‚úÖ üîµ

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π

### 8.1. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/pages/ProfilePage.tsx`
  - [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∫—Ä–µ–¥–∏—Ç–æ–≤
  - [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏ (—Ç–∏–ø, –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è)
  - [x] –ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π (–≥–µ–Ω–µ—Ä–∞—Ü–∏–π)
  - [x] –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
  - [x] –ö–Ω–æ–ø–∫–∞ "–ö—É–ø–∏—Ç—å –∫—Ä–µ–¥–∏—Ç—ã"
  - [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å –ÆKassa (polling —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞)
  - [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ Freemium —Å—á—ë—Ç—á–∏–∫–∞
  - [x] –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–∫–∫–∞—É–Ω—Ç–µ

### 8.2. –ö–≤–∏–∑ –æ–ø–ª–∞—Ç—ã
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/payment/PaymentWizard.tsx`
  - [x] –®–∞–≥ 1: –í—ã–±–æ—Ä —Ç–∏–ø–∞ (–ü–æ–¥–ø–∏—Å–∫–∞ / –ö—Ä–µ–¥–∏—Ç—ã)
  - [x] –®–∞–≥ 2: –í—ã–±–æ—Ä —Ç–∞—Ä–∏—Ñ–∞
  - [x] –®–∞–≥ 3: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ –æ–ø–ª–∞—Ç–∞ (—Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –ÆKassa)
  - [x] –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (1/3, 2/3, 3/3)
  - [x] –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —à–∞–≥–∞–º–∏ (–ù–∞–∑–∞–¥/–î–∞–ª–µ–µ)
  - [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –∏ –ø–æ–¥–ø–∏—Å–∫–∏
  - [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 8.3. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ç–∞—Ä–∏—Ñ–æ–≤
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/payment/SubscriptionCard.tsx`
  - [x] –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏ (–Ω–∞–∑–≤–∞–Ω–∏–µ, —Ü–µ–Ω–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π)
  - [x] –í—ã–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–∞—Ä–∏—Ñ–∞
  - [x] –ö–Ω–æ–ø–∫–∞ "–í—ã–±—Ä–∞—Ç—å"
  - [x] –°–ø–∏—Å–æ–∫ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π —Ç–∞—Ä–∏—Ñ–∞
  - [x] –†–∞—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞ –¥–µ–π—Å—Ç–≤–∏–µ
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/payment/CreditsCard.tsx`
  - [x] –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–∞–∫–µ—Ç–∞ –∫—Ä–µ–¥–∏—Ç–æ–≤
  - [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–æ–Ω—É—Å–Ω—ã—Ö –∫—Ä–µ–¥–∏—Ç–æ–≤
  - [x] –í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞
  - [x] –†–∞—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞ –∫—Ä–µ–¥–∏—Ç
  - [x] –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫—Ä–µ–¥–∏—Ç–æ–≤

### 8.4. API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/api/payment.ts`
  - [x] `createPayment(request: PaymentCreateRequest) -> Promise<PaymentCreateResponse>`
  - [x] `getPaymentStatus(paymentId: string) -> Promise<PaymentStatusResponse>`
  - [x] `getPaymentHistory(page, pageSize) -> Promise<PaymentHistoryResponse>`
  - [x] `getTariffs() -> Promise<TariffsListResponse>`
  - [x] `openPaymentWindow(confirmationUrl: string)` ‚Äî –æ—Ç–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞ –æ–ø–ª–∞—Ç—ã
  - [x] `handlePaymentReturn()` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å –ÆKassa
  - [x] `pollPaymentStatus()` ‚Äî polling –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞

### 8.5. Zustand store –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/store/paymentStore.ts`
  - [x] State: `selectedType`, `selectedTariff`, `paymentHistory`, `tariffs`, `isLoading`, `error`, `currentPaymentId`
  - [x] Actions: `setSelectedType()`, `selectSubscription()`, `selectCreditsPackage()`, `loadTariffs()`, `loadPaymentHistory()`, `createPayment()`, `reset()`, `clearError()`
  - [x] Hook `usePayment()` —Å computed values

### 8.6. TypeScript —Ç–∏–ø—ã
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/types/payment.ts`
  - [x] –ü–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö API responses
  - [x] Enum —Ç–∏–ø—ã (PaymentType, SubscriptionType, PaymentStatus)
  - [x] –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ç–∏–ø—ã (SelectedTariff, TaxBreakdown)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (‚è≥)
- ‚è≥ E2E —Ç–µ—Å—Ç: –≤—ã–±–æ—Ä —Ç–∞—Ä–∏—Ñ–∞ ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç

### –ò—Ç–æ–≥–æ –ø–æ –≠—Ç–∞–ø—É 8
- ‚úÖ **Frontend –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** (7 –º–æ–¥—É–ª–µ–π —Å–æ–∑–¥–∞–Ω–æ)
- ‚úÖ **–°–æ–∑–¥–∞–Ω–æ 4 UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞**: ProfilePage, PaymentWizard, SubscriptionCard, CreditsCard
- ‚úÖ **–°–æ–∑–¥–∞–Ω 1 API –∫–ª–∏–µ–Ω—Ç**: payment.ts —Å polling –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –≤–æ–∑–≤—Ä–∞—Ç–∞
- ‚úÖ **–°–æ–∑–¥–∞–Ω 1 Zustand store**: paymentStore.ts —Å hook `usePayment()`
- ‚úÖ **–°–æ–∑–¥–∞–Ω 1 —Ñ–∞–π–ª —Ç–∏–ø–æ–≤**: payment.ts —Å –ø–æ–ª–Ω–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π
- üîç **–î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å backend
- ‚è≥ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** E2E —Ç–µ—Å—Ç—ã –æ–∂–∏–¥–∞—é—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–≠—Ç–∞–ø 8 –∑–∞–≤–µ—Ä—à—ë–Ω! UI –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π –∏ –ø—Ä–æ—Ñ–∏–ª—è –≥–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é. –°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø: –≠—Ç–∞–ø 9 (Freemium –∏ –≤–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏).**

---

## –≠—Ç–∞–ø 9: Freemium –∏ –≤–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏ ‚úÖ ‚ö™

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π-–°—Ä–µ–¥–Ω–∏–π

### 9.1. Backend: –í–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/services/watermark.py`
  - [x] –§—É–Ω–∫—Ü–∏—è `add_watermark(image_path: str, text: str) -> str`
  - [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PIL/Pillow –¥–ª—è –Ω–∞–ª–æ–∂–µ–Ω–∏—è
  - [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∏–ª—è –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ (–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å, –ø–æ–∑–∏—Ü–∏—è)
  - [x] –ö–ª–∞—Å—Å `WatermarkService` —Å –≥–∏–±–∫–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
  - [x] –ú–µ—Ç–æ–¥ `add_watermark()` –¥–ª—è —Ñ–∞–π–ª–æ–≤
  - [x] –ú–µ—Ç–æ–¥ `add_watermark_to_bytes()` –¥–ª—è bytes
  - [x] Singleton instance `get_watermark_service()`
  - [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π (bottom-right, center, etc.)
  - [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —à—Ä–∏—Ñ—Ç–∞
  - [x] –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω –ø–æ–¥ —Ç–µ–∫—Å—Ç–æ–º –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏

### 9.2. Backend: –°–±—Ä–æ—Å Freemium —Å—á—ë—Ç—á–∏–∫–∞
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `app/models/user.py`
  - [x] –ú–µ—Ç–æ–¥ `reset_freemium_if_needed()` (–ø—Ä–æ–≤–µ—Ä–∫–∞ 30 –¥–Ω–µ–π) - –£–ñ–ï –°–£–©–ï–°–¢–í–£–ï–¢
- ‚úÖ –°–æ–∑–¥–∞—Ç—å Celery periodic task
  - [x] –ó–∞–¥–∞—á–∞ `reset_freemium_counters_task()` (–∑–∞–ø—É—Å–∫ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ) - –£–ñ–ï –°–£–©–ï–°–¢–í–£–ï–¢
  - [x] –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –≤ beat_schedule celery_app.py
  - [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å —Å—á—ë—Ç—á–∏–∫–æ–≤ —á–µ—Ä–µ–∑ 30 –¥–Ω–µ–π

### 9.3. Frontend: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
  - [x] –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å "–û—Å—Ç–∞–ª–æ—Å—å X –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π" –≤ UI
    - [x] ProfilePage - Freemium —Å—á—ë—Ç—á–∏–∫ (–£–ñ–ï –°–£–©–ï–°–¢–í–£–ï–¢)
    - [x] Step3Zone - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞–ª–∞–Ω—Å–µ –∏ Freemium (–£–ñ–ï –°–£–©–ï–°–¢–í–£–ï–¢)
    - [x] ChatInput - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞–ª–∞–Ω—Å–µ –∏ Freemium
  - [x] –í–æ–¥—è–Ω–æ–π –∑–Ω–∞–∫ –Ω–∞ preview —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ Freemium
    - [x] FittingResult - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ (–£–ñ–ï –°–£–©–ï–°–¢–í–£–ï–¢)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (‚è≥)
- ‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö
- ‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–±—Ä–æ—Å–∞ —Å—á—ë—Ç—á–∏–∫–∞

### –ò—Ç–æ–≥–æ –ø–æ –≠—Ç–∞–ø—É 9
- ‚úÖ **Backend –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** (1 –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å —Å–æ–∑–¥–∞–Ω)
- ‚úÖ **–°–æ–∑–¥–∞–Ω WatermarkService**: watermark.py —Å –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é
- ‚úÖ **Freemium –ª–æ–≥–∏–∫–∞**: —É–∂–µ –±—ã–ª–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ –≠—Ç–∞–ø–∞—Ö 2-7
- ‚úÖ **Frontend –æ–±–Ω–æ–≤–ª—ë–Ω**: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Freemium –≤ ChatInput
- üîç **–î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** –í–æ–¥—è–Ω–æ–π –∑–Ω–∞–∫ –º–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å Freemium –∞–∫–∫–∞—É–Ω—Ç–æ–º
- ‚è≥ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ –∏ Celery –∑–∞–¥–∞—á–∏

**–≠—Ç–∞–ø 9 –∑–∞–≤–µ—Ä—à—ë–Ω! Freemium –∏ –≤–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã. –°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø: –≠—Ç–∞–ø 10 (–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞).**

---

## –≠—Ç–∞–ø 10: –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ ‚úÖ ‚ö™

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π

### 10.1. Backend API
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/schemas/referral.py`
  - [x] Pydantic —Å—Ö–µ–º—ã –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
  - [x] ReferralLinkResponse, ReferralRegisterRequest, ReferralStatsResponse
  - [x] ReferralItem —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞—Ö
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/api/v1/endpoints/referrals.py`
  - [x] `GET /api/v1/referrals/link` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏
  - [x] `POST /api/v1/referrals/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–µ
  - [x] `GET /api/v1/referrals/stats` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
  - [x] –§—É–Ω–∫—Ü–∏—è `generate_referral_code()` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ (SHA-256)
  - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞: –Ω–µ–ª—å–∑—è –ø—Ä–∏–≥–ª–∞—Å–∏—Ç—å —Å–∞–º–æ–≥–æ —Å–µ–±—è
  - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–≥–ª–∞—à—ë–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
  - [x] –õ–æ–≥–∏–∫–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è +10 –∫—Ä–µ–¥–∏—Ç–æ–≤ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª–∞
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `app/core/config.py`
  - [x] –î–æ–±–∞–≤–ª–µ–Ω BOT_USERNAME –¥–ª—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `app/main.py`
  - [x] –ü–æ–¥–∫–ª—é—á—ë–Ω referrals router
  - [x] –¢–µ–≥ "referrals" –¥–ª—è Swagger UI
  - [x] –í–µ—Ä—Å–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ 0.10.0

### 10.2. Frontend UI
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/api/referral.ts`
  - [x] `getReferralLink()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏
  - [x] `registerReferral()` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–æ–¥—É
  - [x] `getReferralStats()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
  - [x] `copyReferralLink()` ‚Äî –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –≤ –±—É—Ñ–µ—Ä
  - [x] –ü–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è TypeScript
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å ProfilePage
  - [x] –°–µ–∫—Ü–∏—è "–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞"
  - [x] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: –≤—Å–µ–≥–æ –¥—Ä—É–∑–µ–π, –∞–∫—Ç–∏–≤–Ω—ã—Ö, –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤
  - [x] –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ —Å –∫–Ω–æ–ø–∫–∞–º–∏ "–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å" –∏ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è"
  - [x] –°–ø–∏—Å–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ —Å –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π —Å—Ç–∞—Ç—É—Å–∞ (–∞–∫—Ç–∏–≤–Ω—ã–π/–æ–∂–∏–¥–∞—é—â–∏–π)
  - [x] Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (‚è≥)
- ‚è≥ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è referrals endpoints
- ‚è≥ E2E —Ç–µ—Å—Ç: –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥—Ä—É–≥–∞ ‚Üí —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –ø–æ–ª—É—á–µ–Ω–∏–µ –±–æ–Ω—É—Å–∞

### –ò—Ç–æ–≥–æ –ø–æ –≠—Ç–∞–ø—É 10
- ‚úÖ **Backend –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** (2 –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª—è —Å–æ–∑–¥–∞–Ω–æ)
- ‚úÖ **–°–æ–∑–¥–∞–Ω–æ 2 —Å–µ—Ä–≤–∏—Å–∞**: referral.py (—Å—Ö–µ–º—ã), referrals.py (endpoints)
- ‚úÖ **–°–æ–∑–¥–∞–Ω–æ 3 API endpoints**: /link, /register, /stats
- ‚úÖ **Frontend –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** (1 –º–æ–¥—É–ª—å + –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ProfilePage)
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ main.py**: referrals router –ø–æ–¥–∫–ª—é—á—ë–Ω
- üîç **–î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- ‚è≥ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** Unit –∏ E2E —Ç–µ—Å—Ç—ã –æ–∂–∏–¥–∞—é—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–≠—Ç–∞–ø 10 –∑–∞–≤–µ—Ä—à—ë–Ω! –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞. –°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø: –≠—Ç–∞–ø 11 (–ê–¥–º–∏–Ω–∫–∞).**

---

## –≠—Ç–∞–ø 11: –ê–¥–º–∏–Ω–∫–∞ ‚úÖ ‚ö™

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π

### 11.1. Backend API
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/schemas/admin.py`
  - [x] Pydantic —Å—Ö–µ–º—ã –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
  - [x] AdminStats, AdminUsersResponse, PaymentExportResponse
  - [x] AdminChartsData –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `app/api/v1/endpoints/admin.py`
  - [x] `GET /api/v1/admin/stats` ‚Äî –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–∑–∞—â–∏—â–µ–Ω–æ ADMIN_SECRET_KEY)
  - [x] `GET /api/v1/admin/charts` ‚Äî –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π)
  - [x] `GET /api/v1/admin/users` ‚Äî —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
  - [x] `GET /api/v1/admin/payments/export` ‚Äî —ç–∫—Å–ø–æ—Ä—Ç CSV/JSON –¥–ª—è –Ω–∞–ª–æ–≥–æ–≤
  - [x] Dependency `verify_admin_secret()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ X-Admin-Secret –∑–∞–≥–æ–ª–æ–≤–∫–∞
  - [x] –ü–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –ø–ª–∞—Ç–µ–∂–∏, –ø–æ–¥–ø–∏—Å–∫–∏, —Ä–µ—Ñ–µ—Ä–∞–ª—ã, Freemium
  - [x] –†–∞—Å—á—ë—Ç –ù–ü–î –Ω–∞–ª–æ–≥–∞ –∏ –∫–æ–º–∏—Å—Å–∏–∏ –ÆKassa –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `app/core/config.py`
  - [x] ADMIN_SECRET_KEY —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `.env.example`
  - [x] ADMIN_SECRET_KEY, FRONTEND_URL, BOT_USERNAME –¥–æ–±–∞–≤–ª–µ–Ω—ã
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `app/main.py`
  - [x] –ü–æ–¥–∫–ª—é—á—ë–Ω admin router
  - [x] –¢–µ–≥ "admin" –¥–ª—è Swagger UI
  - [x] –í–µ—Ä—Å–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ 0.11.0

### 11.2. Frontend UI
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/types/admin.ts`
  - [x] –ü–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö API responses
  - [x] AdminStats, AdminChartsData, AdminUsersResponse, PaymentExportResponse
  - [x] StatsCardData, ChartConfig –¥–ª—è UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/api/admin.ts`
  - [x] `getAdminStats()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
  - [x] `getAdminCharts()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
  - [x] `getAdminUsers()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - [x] `exportPaymentsJSON()` ‚Äî —ç–∫—Å–ø–æ—Ä—Ç –ø–ª–∞—Ç–µ–∂–µ–π –≤ JSON
  - [x] `exportPaymentsCSV()` ‚Äî —ç–∫—Å–ø–æ—Ä—Ç –ø–ª–∞—Ç–µ–∂–µ–π –≤ CSV –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ
  - [x] –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å ADMIN_SECRET_KEY (get, set, clear, has)
  - [x] –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏: formatNumber, formatCurrency, formatDate, formatRelativeTime
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/admin/StatsCard.tsx`
  - [x] –ö–∞—Ä—Ç–æ—á–∫–∞ –º–µ—Ç—Ä–∏–∫–∏ —Å –∏–∫–æ–Ω–∫–æ–π –∏ –∑–Ω–∞—á–µ–Ω–∏–µ–º
  - [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–∑–µ–ª—ë–Ω—ã–π/–∫—Ä–∞—Å–Ω—ã–π)
  - [x] –¶–≤–µ—Ç–æ–≤—ã–µ —Å—Ö–µ–º—ã (blue, green, yellow, red, purple, indigo)
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/components/admin/UsersTable.tsx`
  - [x] –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
  - [x] –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è: –ø–æ–∏—Å–∫, –∞–∫—Ç–∏–≤–Ω—ã–µ/–Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ
  - [x] –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Å–µ–º –ø–æ–ª—è–º (ID, username, –¥–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)
  - [x] –ü–∞–≥–∏–Ω–∞—Ü–∏—è (50 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É)
  - [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ: –±–∞–ª–∞–Ω—Å, –ø–æ–¥–ø–∏—Å–∫–∞, –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞, —Ä–µ—Ñ–µ—Ä–∞–ª—ã
  - [x] –ò–Ω–¥–∏–∫–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/pages/AdminPage.tsx`
  - [x] –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤–≤–æ–¥–∞ ADMIN_SECRET_KEY
  - [x] –î–∞—à–±–æ—Ä–¥ —Å 9 –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–≤–∫–ª—é—á–∞—è —Ä–µ—Ñ–µ—Ä–∞–ª—ã)
  - [x] –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –ø–ª–∞—Ç–µ–∂–∏, —Ä–µ—Ñ–µ—Ä–∞–ª—ã)
  - [x] –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
  - [x] –ö–Ω–æ–ø–∫–∏: –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, —ç–∫—Å–ø–æ—Ä—Ç CSV, –∏–∑–º–µ–Ω–∏—Ç—å –∫–ª—é—á
  - [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (–Ω–µ–≤–µ—Ä–Ω—ã–π –∫–ª—é—á, —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏)
  - [x] –û–ë–ù–û–í–õ–ï–ù–û v0.16.0: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–∞–Ω–µ–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ (–≤—Å–µ–≥–æ, –∞–∫—Ç–∏–≤–Ω—ã—Ö, % –∫–æ–Ω–≤–µ—Ä—Å–∏–∏)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (‚è≥)
- ‚è≥ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è admin endpoints
- ‚è≥ E2E —Ç–µ—Å—Ç: –≤—Ö–æ–¥ ‚Üí –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ ‚Üí —ç–∫—Å–ø–æ—Ä—Ç –ø–ª–∞—Ç–µ–∂–µ–π

### –ò—Ç–æ–≥–æ –ø–æ –≠—Ç–∞–ø—É 11
- ‚úÖ **Backend –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** (2 –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª—è —Å–æ–∑–¥–∞–Ω–æ)
- ‚úÖ **–°–æ–∑–¥–∞–Ω–æ 2 —Å–µ—Ä–≤–∏—Å–∞**: admin.py (—Å—Ö–µ–º—ã), admin.py (endpoints)
- ‚úÖ **–°–æ–∑–¥–∞–Ω–æ 4 API endpoints**: /stats, /charts, /users, /payments/export
- ‚úÖ **Frontend –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** (5 –º–æ–¥—É–ª–µ–π —Å–æ–∑–¥–∞–Ω–æ)
- ‚úÖ **–°–æ–∑–¥–∞–Ω–æ 3 UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞**: StatsCard, UsersTable, AdminPage
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ main.py**: admin router –ø–æ–¥–∫–ª—é—á—ë–Ω, –≤–µ—Ä—Å–∏—è 0.11.0
- üîç **–î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** –ê–¥–º–∏–Ω–∫–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é (—Ç—Ä–µ–±—É–µ—Ç ADMIN_SECRET_KEY)
- ‚è≥ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** Unit –∏ E2E —Ç–µ—Å—Ç—ã –æ–∂–∏–¥–∞—é—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- üÜï **–û–ë–ù–û–í–õ–ï–ù–û v0.16.0:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ (9 –∫–∞—Ä—Ç–æ—á–µ–∫, 4 –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ø–∞–Ω–µ–ª–∏)

**–≠—Ç–∞–ø 11 –∑–∞–≤–µ—Ä—à—ë–Ω! –ê–¥–º–∏–Ω–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞. –°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø: –≠—Ç–∞–ø 13 (–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è).**

---

## –≠—Ç–∞–ø 12: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Google –∏ Email (Frontend + Backend) ‚úÖ ‚ö°

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### 12.1. Backend –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (‚úÖ –ó–ê–í–ï–†–®–Å–ù)
- ‚úÖ Email/Password –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
- ‚úÖ Google OAuth –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è —Å–µ—Å—Å–∏–π
- ‚úÖ –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã: `/api/v1/auth-web/login`, `/api/v1/auth-web/register`, `/api/v1/auth-web/google`

### 12.2. Frontend –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (‚úÖ –ó–ê–í–ï–†–®–Å–ù)
- ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü—ã –ª–æ–≥–∏–Ω–∞ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (LoginPage, RegisterPage)
- ‚úÖ Google Sign-In –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (GoogleSignInButton)
- ‚úÖ AuthGuard –¥–ª—è –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö —Ä–æ—É—Ç–æ–≤
- ‚úÖ Zustand store –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ localStorage
- ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞

### 12.3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (‚úÖ –ó–ê–í–ï–†–®–ï–ù–û - 2025-01-20)

#### –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. ‚ùå **–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ Google Identity Services**
   - –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—ã—Ç–∞–ª—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `window.google` –¥–æ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞
   - –û—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏: `"Google Identity Services not loaded. Add script to index.html"`

2. ‚ö†Ô∏è **–ù–µ–≤–µ—Ä–Ω—ã–π Google Client ID –≤ .env**
   - Client ID –Ω–µ –≤–∞–ª–∏–¥–Ω—ã–π (403 –æ—à–∏–±–∫–∞ –æ—Ç Google API)
   - –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã email-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

**GoogleSignInButton.tsx** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ Google Identity Services:
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω retry –º–µ—Ö–∞–Ω–∏–∑–º —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏ (10 –ø–æ–ø—ã—Ç–æ–∫ √ó 500ms)
- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
- ‚úÖ –ï—Å–ª–∏ Google —Å–∫—Ä–∏–ø—Ç –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω - –¥–µ–ª–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å try-catch –±–ª–æ–∫–æ–º
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —É—Å–ª–æ–≤–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ –£–±—Ä–∞–Ω—ã –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (Playwright MCP):

‚úÖ **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ email:**
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: —Ç–µ—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `test@example.com` —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω
- –õ–æ–≥–∏–Ω: –≤—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –†–µ–¥–∏—Ä–µ–∫—Ç: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞
- –°–µ—Å—Å–∏—è: —Ç–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Å—Ç–∞—ë—Ç—Å—è –∑–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω—ã–º

‚úÖ **–°—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (`/`) - –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã–±–æ—Ä —Ñ—É–Ω–∫—Ü–∏–π
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è (`/profile`) - –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è, –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏–º–µ—Ä–∫–∏ (`/fitting`) - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç wizard
- –ú–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

‚úÖ **Google Sign-In:**
- –ö–Ω–æ–ø–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ù–µ—Ç –æ—à–∏–±–æ–∫ –æ –Ω–µ–∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–º Google Identity Services
- –û—Å—Ç–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∞ 403 –æ—Ç Google API (–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π Client ID) - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è dev-–æ–∫—Ä—É–∂–µ–Ω–∏—è

#### –°–∫—Ä–∏–Ω—à–æ—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- `login-page-errors.png` - –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å –æ—à–∏–±–∫–∞–º–∏
- `register-form-filled.png` - —Ñ–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞
- `homepage-logged-in.png` - –≥–ª–∞–≤–Ω–∞—è –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞
- `profile-page.png` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è
- `fitting-page.png` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏–º–µ—Ä–∫–∏
- `login-after-fix.png` - –ª–æ–≥–∏–Ω –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- `login-success-final.png` - —É—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥

#### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:
- ‚úÖ `frontend/src/components/auth/GoogleSignInButton.tsx` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

### –ò—Ç–æ–≥–æ –ø–æ –≠—Ç–∞–ø—É 12:
- ‚úÖ **Backend:** Email –∏ Google –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ **Frontend:** –í—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã
- ‚úÖ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** Playwright —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã—è–≤–∏–ª–æ –∏ –∏—Å–ø—Ä–∞–≤–∏–ª–æ 1 –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –æ—à–∏–±–∫—É
- ‚úÖ **–ö–∞—á–µ—Å—Ç–≤–æ:** –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- üìù **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Google Sign-In –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å –≤–∞–ª–∏–¥–Ω—ã–π Client ID –≤ Google Cloud Console

**–≠—Ç–∞–ø 12 –∑–∞–≤–µ—Ä—à—ë–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω! –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞. –ü–µ—Ä–µ—Ö–æ–¥ –∫ –≠—Ç–∞–ø—É 13 (–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è).**

---

## –≠—Ç–∞–ø 13: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è üöß ‚ö°

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π ‚Äî –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 13.1. Unit-—Ç–µ—Å—Ç—ã Backend (‚úÖ –ó–ê–í–ï–†–®–Å–ù —á–∞—Å—Ç–∏—á–Ω–æ)

#### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –º–æ–¥—É–ª–∏:

- ‚úÖ **test_auth.py** (8 —Ç–µ—Å—Ç–æ–≤):
  - TestJWT: 5 —Ç–µ—Å—Ç–æ–≤ JWT —Ç–æ–∫–µ–Ω–æ–≤ (—Å–æ–∑–¥–∞–Ω–∏–µ, –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è, —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è)
  - TestAuthAPI: 4 integration —Ç–µ—Å—Ç–∞ (skipped, —Ç—Ä–µ–±—É—é—Ç test DB)

- ‚úÖ **test_credits.py** (10+ —Ç–µ—Å—Ç–æ–≤):
  - TestCheckUserCanPerformAction: 6 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—è
  - TestDeductCredits: 4 —Ç–µ—Å—Ç–∞ —Å–ø–∏—Å–∞–Ω–∏—è –∫—Ä–µ–¥–∏—Ç–æ–≤ (credits, subscription, freemium)
  - TestAwardCredits: 1 —Ç–µ—Å—Ç –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∫—Ä–µ–¥–∏—Ç–æ–≤
  - TestAwardSubscription: 2 —Ç–µ—Å—Ç–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏

- ‚úÖ **test_file_validator.py** (10+ —Ç–µ—Å—Ç–æ–≤):
  - TestValidateImageFile: 7 —Ç–µ—Å—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (JPEG, PNG, MIME, magic bytes, size)
  - TestGetFileExtension: 4 —Ç–µ—Å—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–∞
  - TestGetImageDimensions: 2 —Ç–µ—Å—Ç–∞ (skipped, —Ç—Ä–µ–±—É—é—Ç PIL)

- ‚úÖ **test_tax.py** (24 —Ç–µ—Å—Ç–∞, 23 passed, 1 skipped):
  - TestCalculateNPDTax: 4 —Ç–µ—Å—Ç–∞ —Ä–∞—Å—á—ë—Ç–∞ –ù–ü–î (4%)
  - TestCalculateYuKassaCommission: 4 —Ç–µ—Å—Ç–∞ —Ä–∞—Å—á—ë—Ç–∞ –∫–æ–º–∏—Å—Å–∏–∏ –ÆKassa (2.8%)
  - TestCalculateTotalDeductions: 3 —Ç–µ—Å—Ç–∞ –æ–±—â–∏—Ö –≤—ã—á–µ—Ç–æ–≤
  - TestCalculateNetAmount: 3 —Ç–µ—Å—Ç–∞ —á–∏—Å—Ç–æ–π —Å—É–º–º—ã
  - TestCalculateGrossAmount: 2 —Ç–µ—Å—Ç–∞ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —Ä–∞—Å—á—ë—Ç–∞
  - TestFormatTaxBreakdown: 3 —Ç–µ—Å—Ç–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–∑–±–∏–≤–∫–∏
  - TestRealWorldScenarios: 5 —Ç–µ—Å—Ç–æ–≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (—Ç–∞—Ä–∏—Ñ—ã 299‚ÇΩ, 499‚ÇΩ, 899‚ÇΩ, 199‚ÇΩ)

- ‚úÖ **test_editing_module.py** (14 —Ç–µ—Å—Ç–æ–≤, –≤—Å–µ –ø—Ä–æ–π–¥–µ–Ω—ã):
  - –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä unit-—Ç–µ—Å—Ç–æ–≤ –¥–ª—è –º–æ–¥—É–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- ‚úÖ **test_api_integration.py** (—à–∞–±–ª–æ–Ω—ã –¥–ª—è –≤—Å–µ—Ö API):
  - TestAuthAPIIntegration: 4 —Ç–µ—Å—Ç–∞
  - TestFittingAPIIntegration: 4 —Ç–µ—Å—Ç–∞
  - TestEditingAPIIntegration: 3 —Ç–µ—Å—Ç–∞
  - TestPaymentsAPIIntegration: 5 —Ç–µ—Å—Ç–æ–≤
  - TestReferralsAPIIntegration: 4 —Ç–µ—Å—Ç–∞
  - TestAdminAPIIntegration: 4 —Ç–µ—Å—Ç–∞
  - **–í—Å–µ –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ skipped** (—Ç—Ä–µ–±—É—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É test database)

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

- ‚úÖ **pytest.ini** ‚Äî –ø–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest:
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞—Ä–∫–µ—Ä–æ–≤ (unit, integration, slow, asyncio)
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞ (--cov=app)
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã–≤–æ–¥–∞ (verbose, –ø–æ–∫–∞–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)
  - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è pytest 7.0
  - asyncio_mode = auto

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

- ‚úÖ **60 —Ç–µ—Å—Ç–æ–≤ —Å–æ–±—Ä–∞–Ω–æ**:
  - **23/24 —Ç–µ—Å—Ç–∞ –ø—Ä–æ–π–¥–µ–Ω—ã** –≤ test_tax.py (95.8% success rate)
  - **14/14 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω—ã** –≤ test_editing_module.py (100% success rate)
  - **1 —Ç–µ—Å—Ç skipped** (test_yukassa_commission_custom_rate ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä)
  - **24 integration —Ç–µ—Å—Ç–∞ skipped** (—Ç—Ä–µ–±—É—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É test database)

- ‚úÖ **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞**: tax.py ‚Äî 93% (41/44 —Å—Ç—Ä–æ–∫ –ø–æ–∫—Ä—ã—Ç—ã)

#### –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

- ‚úÖ `pytest==7.4.4` ‚Äî —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ `pytest-asyncio==0.23.3` ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ async —Ç–µ—Å—Ç–æ–≤
- ‚úÖ `pytest-cov==4.1.0` ‚Äî –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
- ‚úÖ `python-jose[cryptography]==3.5.0` ‚Äî JWT —Ç–æ–∫–µ–Ω—ã (–¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –±–∞–≥–∏:

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ "testing" –≤ allowed ENVIRONMENT values (config.py)
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω python-jose –º–æ–¥—É–ª—å
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã tax.py –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é

### 13.2. Unit-—Ç–µ—Å—Ç—ã Frontend (‚è≥ TODO)

- ‚è≥ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Jest + React Testing Library
- ‚è≥ –¢–µ—Å—Ç—ã –¥–ª—è authStore, fittingStore, chatStore
- ‚è≥ –¢–µ—Å—Ç—ã –¥–ª—è AuthGuard, FittingWizard, ChatWindow
- ‚è≥ –¢–µ—Å—Ç—ã –¥–ª—è API –∫–ª–∏–µ–Ω—Ç–æ–≤ (auth.ts, fitting.ts, editing.ts)

### 13.3. E2E —Ç–µ—Å—Ç—ã (‚è≥ TODO)

- ‚è≥ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Playwright
- ‚è≥ E2E —Ç–µ—Å—Ç: –ø–æ–ª–Ω—ã–π flow –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚è≥ E2E —Ç–µ—Å—Ç: –ø–æ–ª–Ω—ã–π flow –ø—Ä–∏–º–µ—Ä–∫–∏
- ‚è≥ E2E —Ç–µ—Å—Ç: –ø–æ–ª–Ω—ã–π flow —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚è≥ E2E —Ç–µ—Å—Ç: –ø–æ–ª–Ω—ã–π flow –æ–ø–ª–∞—Ç—ã

### 13.4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (‚úÖ –ó–ê–í–ï–†–®–ï–ù–ê)

- ‚úÖ **TESTING.md** (250+ —Å—Ç—Ä–æ–∫):
  - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤
  - Backend —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞, —Å–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç–æ–≤)
  - Frontend —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (TODO)
  - E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (TODO)
  - Continuous Integration (TODO)
  - –ù–∞–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤ (–ø—Ä–∞–≤–∏–ª–∞, –ø—Ä–∏–º–µ—Ä—ã)
  - –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞
  - –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- ‚úÖ **OPTIMIZATION.md** (300+ —Å—Ç—Ä–æ–∫):
  - Backend –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–∏–Ω–¥–µ–∫—Å—ã –ë–î, query –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, caching, async, Celery)
  - Frontend –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (code splitting, image optimization, memoization, Zustand, bundle size)
  - Database –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (connection pooling, EXPLAIN ANALYZE, partitioning, vacuum)
  - Monitoring –∏ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (backend profiling, frontend profiling, Sentry, Prometheus)
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–µ–ø–ª–æ—é (–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, CDN, load balancer)
  - –¢–µ–∫—É—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  - –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ production

### 13.5. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Backend (‚è≥ –ü–ª–∞–Ω—ã)

–í—Å–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ OPTIMIZATION.md:

- ‚è≥ –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –ë–î (py-spy, SQL query logging)
- ‚è≥ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ (–∫–æ–º–ø–æ–∑–∏—Ç–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)
- ‚è≥ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ connection pooling (—Ä–∞–∑–º–µ—Ä –ø—É–ª–∞, max overflow)
- ‚è≥ Caching —Å Redis (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–¥–º–∏–Ω–∫–∏, —á–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã)
- ‚è≥ Celery –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–æ—á–µ—Ä–µ–¥–∏ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º, rate limiting)

### 13.6. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Frontend (‚è≥ –ü–ª–∞–Ω—ã)

–í—Å–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ OPTIMIZATION.md:

- ‚è≥ Code splitting (lazy loading –¥–ª—è routes)
- ‚è≥ Image optimization (lazy loading, thumbnails)
- ‚è≥ Memoization (React.memo, useMemo, useCallback)
- ‚è≥ Zustand –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (—Å–µ–ª–µ–∫—Ç–æ—Ä—ã)
- ‚è≥ Bundle size –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (tree shaking, –∞–Ω–∞–ª–∏–∑ bundle size)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (‚úÖ –ß–∞—Å—Ç–∏—á–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ)

- ‚úÖ Backend unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–¥—É–ª–µ–π (60 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é (TESTING.md)
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (OPTIMIZATION.md)
- ‚è≥ Integration —Ç–µ—Å—Ç—ã (—Ç—Ä–µ–±—É—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É test database)
- ‚è≥ Frontend unit-—Ç–µ—Å—Ç—ã (—Ç—Ä–µ–±—É—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É Jest)
- ‚è≥ E2E —Ç–µ—Å—Ç—ã (—Ç—Ä–µ–±—É—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É Playwright)

### –ò—Ç–æ–≥–æ –ø–æ –≠—Ç–∞–ø—É 13

- ‚úÖ **Backend Unit-—Ç–µ—Å—Ç—ã:** 60 —Ç–µ—Å—Ç–æ–≤ —Å–æ–∑–¥–∞–Ω–æ, 37 –ø—Ä–æ–π–¥–µ–Ω–æ, 1 skipped, 24 —Ç—Ä–µ–±—É—é—Ç test DB
- ‚úÖ **–¢–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã:** 6 —Ñ–∞–π–ª–æ–≤ (auth, credits, file_validator, tax, editing, api_integration)
- ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** pytest.ini –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** TESTING.md (250+ —Å—Ç—Ä–æ–∫)
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** OPTIMIZATION.md (300+ —Å—Ç—Ä–æ–∫)
- ‚úÖ **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞:** tax.py ‚Äî 93%, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ —Ç—Ä–µ–±—É—é—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ **–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** pytest, pytest-asyncio, pytest-cov, python-jose
- ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –±–∞–≥–∏:** config ENVIRONMENT, python-jose —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- ‚è≥ **Frontend —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –û–∂–∏–¥–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Jest + RTL
- ‚è≥ **E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –û–∂–∏–¥–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Playwright
- ‚è≥ **Integration —Ç–µ—Å—Ç—ã:** –¢—Ä–µ–±—É—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É test database
- ‚è≥ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–∂–∏–¥–∞–µ—Ç

**–≠—Ç–∞–ø 13 –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ! Backend —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ 60% –∑–∞–≤–µ—Ä—à–µ–Ω–æ. –ì–æ—Ç–æ–≤–æ –∫ –ø–µ—Ä–µ—Ö–æ–¥—É –∫ frontend —Ç–µ—Å—Ç–∞–º –∏–ª–∏ integration —Ç–µ—Å—Ç–∞–º —Å test DB.**

---

## –≠—Ç–∞–ø 14: –î–µ–ø–ª–æ–π –Ω–∞ VPS https://dockerhosting.ru ‚è≥

### 14.1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
- ‚è≥ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –∏ Portainer (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)
- ‚è≥ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ nginx –∫–∞–∫ reverse proxy
- ‚è≥ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (Let's Encrypt)

### 14.2. –î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Docker Compose
- ‚è≥ –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤
- ‚è≥ –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (backend, frontend, PostgreSQL, Redis, Celery)

### 14.3. CI/CD
- ‚è≥ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Actions –¥–ª—è –∞–≤—Ç–æ–¥–µ–ø–ª–æ—è

---

## –≠—Ç–∞–ø 15: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ ‚è≥

### 15.1. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚è≥ –û–±–Ω–æ–≤–∏—Ç—å README.md —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ –¥–µ–ø–ª–æ—é
- ‚è≥ API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (Swagger UI)
- ‚è≥ User guide –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

### 15.2. –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
- ‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ production
- ‚è≥ –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚è≥ Security audit

---

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

1. ‚ö° **–≠—Ç–∞–ø 3-4: –ü—Ä–∏–º–µ—Ä–∫–∞ (Backend + Frontend)** (–æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è #1)
2. üîµ **–≠—Ç–∞–ø 5-6: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Backend + Frontend)** (–æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è #2)
3. üîµ **–≠—Ç–∞–ø 7-8: –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –∏ –ø–ª–∞—Ç–µ–∂–∏** (–≤–∞–∂–Ω–æ –¥–ª—è –±–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª–∏)
4. ‚ö™ **–≠—Ç–∞–ø 9-10: Freemium –∏ —Ä–µ—Ñ–µ—Ä–∞–ª—ã** (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏—á–∏)
5. ‚ö™ **–≠—Ç–∞–ø 11: –ê–¥–º–∏–Ω–∫–∞** (–≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç)
6. ‚è≥ **–≠—Ç–∞–ø 13-15: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –¥–µ–ø–ª–æ–π, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** (—Ñ–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞–¥–∏—è)

---

## –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**–ù–∞—á–∞—Ç—å —Å –≠—Ç–∞–ø–∞ 3: API –¥–ª—è –ø—Ä–∏–º–µ—Ä–∫–∏ –æ–¥–µ–∂–¥—ã**

–≠—Ç–∏ –∑–∞–¥–∞—á–∏ –ª–µ–∂–∞—Ç –≤ –æ—Å–Ω–æ–≤–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è (–≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ø—Ä–∏–º–µ—Ä–∫–∞):
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
- –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- –°–ø–∏—Å–∞–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–æ–≤ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å Freemium
- –î–æ—Å—Ç–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
