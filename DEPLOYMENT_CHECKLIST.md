# üöÄ –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è AI Image Bot –Ω–∞ VPS

## üìã –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### 1. –î–æ—Å—Ç—É–ø—ã –∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

- [ ] SSH –¥–æ—Å—Ç—É–ø –∫ VPS (IP, –ø–æ—Ä—Ç, –ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å/–∫–ª—é—á)
- [ ] –î–æ—Å—Ç—É–ø –∫ Portainer (URL, –ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å)
- [ ] –î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è (–µ—Å–ª–∏ –µ—Å—Ç—å)

### 2. API –∫–ª—é—á–∏ –∏ —Ç–æ–∫–µ–Ω—ã

- [ ] **Telegram Bot Token** (–ø–æ–ª—É—á–∏—Ç—å —É @BotFather)
  - –°–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥–æ–π `/newbot`
  - –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω
  - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Web App URL –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

- [ ] **kie.ai API Key**
  - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ https://kie.ai
  - –ü–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á
  - –ú–æ–¥–µ–ª—å: `nano-banana`

- [ ] **OpenRouter API Key**
  - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ https://openrouter.ai
  - –ü–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á
  - –ú–æ–¥–µ–ª—å: `anthropic/claude-3-haiku-20240307`

- [ ] **–ÆKassa credentials** (–¥–ª—è –ø—Ä–∏–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π)
  - Shop ID
  - Secret Key
  - Webhook Secret
  - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `PAYMENT_MOCK_MODE=true` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 3. –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è VPS

- [ ] **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
  - CPU: 2 cores
  - RAM: 4 GB
  - Disk: 20 GB SSD
  - OS: Ubuntu 20.04+ / Debian 11+

- [ ] **–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ü–û:**
  - [x] Docker (–æ–±—ã—á–Ω–æ –µ—Å—Ç—å —Å Portainer)
  - [x] Docker Compose (–æ–±—ã—á–Ω–æ –µ—Å—Ç—å —Å Portainer)
  - [ ] Git (–¥–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)
  - [ ] Nginx (–¥–ª—è reverse proxy –∏ SSL)

### 4. –°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- [ ] **–û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã –Ω–∞ VPS:**
  - 80 (HTTP)
  - 443 (HTTPS)
  - 22 (SSH)
  - 9000 (Portainer, –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø)

- [ ] **Firewall –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
  - –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Ö–æ–¥—è—â–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ –ø–æ—Ä—Ç—ã 80, 443
  - –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ SSH (–ø–æ—Ä—Ç 22) —Ç–æ–ª—å–∫–æ —Å –≤–∞—à–µ–≥–æ IP

### 5. –î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è –∏ SSL (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

- [ ] –î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –Ω–∞ IP —Å–µ—Ä–≤–µ—Ä–∞
- [ ] DNS –∑–∞–ø–∏—Å–∏:
  - `A` –∑–∞–ø–∏—Å—å: `yourdomain.com` ‚Üí `IP —Å–µ—Ä–≤–µ—Ä–∞`
  - `A` –∑–∞–ø–∏—Å—å: `www.yourdomain.com` ‚Üí `IP —Å–µ—Ä–≤–µ—Ä–∞` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Let's Encrypt SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç

---

## üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è:

```bash
# –û–∫—Ä—É–∂–µ–Ω–∏–µ
ENVIRONMENT=production
DEBUG=False

# Security
SECRET_KEY=                    # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å: openssl rand -hex 32
JWT_SECRET_KEY=                # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å: openssl rand -hex 32
ADMIN_SECRET_KEY=              # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å: openssl rand -hex 32

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
POSTGRES_USER=postgres
POSTGRES_PASSWORD=             # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–¥–µ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å
POSTGRES_DB=ai_image_bot
POSTGRES_HOST=postgres         # –ò–º—è —Å–µ—Ä–≤–∏—Å–∞ –≤ Docker
POSTGRES_PORT=5432

# Redis
REDIS_URL=redis://redis:6379/0

# APIs
KIE_AI_API_KEY=                # –ü–æ–ª—É—á–∏—Ç—å –Ω–∞ kie.ai
OPENROUTER_API_KEY=            # –ü–æ–ª—É—á–∏—Ç—å –Ω–∞ openrouter.ai

# Telegram
TELEGRAM_BOT_TOKEN=            # –ü–æ–ª—É—á–∏—Ç—å —É @BotFather
BOT_USERNAME=                  # –ò–º—è –±–æ—Ç–∞ –±–µ–∑ @

# URLs
WEB_APP_URL=https://yourdomain.com      # URL —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
FRONTEND_URL=https://yourdomain.com      # –¢–æ—Ç –∂–µ URL

# –ÆKassa (–∏–ª–∏ mock –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
YUKASSA_SHOP_ID=
YUKASSA_SECRET_KEY=
YUKASSA_WEBHOOK_SECRET=
PAYMENT_MOCK_MODE=false        # true –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π

# Vite Frontend
VITE_API_BASE_URL=https://yourdomain.com
VITE_ENV=production
```

---

## üì¶ –≠—Ç–∞–ø—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

1. [ ] –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ VPS –ø–æ SSH
2. [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É Docker –∏ Docker Compose
3. [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Git (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
4. [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å firewall (ufw –∏–ª–∏ iptables)

### –≠—Ç–∞–ø 2: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

1. [ ] –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä
2. [ ] –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞

### –≠—Ç–∞–ø 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

1. [ ] –°–æ–∑–¥–∞—Ç—å `.env` —Ñ–∞–π–ª –∏–∑ `.env.example`
2. [ ] –ó–∞–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
3. [ ] –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏
4. [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—Å–µ—Ö API –∫–ª—é—á–µ–π

### –≠—Ç–∞–ø 4: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Portainer

1. [ ] –í–æ–π—Ç–∏ –≤ Portainer
2. [ ] –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π Stack
3. [ ] –ó–∞–≥—Ä—É–∑–∏—Ç—å `docker-compose.prod.yml`
4. [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ `.env`
5. [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å Stack

### –≠—Ç–∞–ø 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx –∏ SSL

1. [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Nginx reverse proxy
2. [ ] –ü–æ–ª—É—á–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç Let's Encrypt
3. [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã HTTP ‚Üí HTTPS

### –≠—Ç–∞–ø 6: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

1. [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ Alembic
2. [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü

### –≠—Ç–∞–ø 7: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –±–æ—Ç–∞

1. [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Menu Button (WebApp URL)
2. [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç–∞ –≤ Telegram

### –≠—Ç–∞–ø 8: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

1. [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤ Portainer
2. [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
3. [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã API
4. [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
5. [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
6. [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞—Ç–µ–∂–Ω—É—é —Å–∏—Å—Ç–µ–º—É (–∏–ª–∏ mock)

### –≠—Ç–∞–ø 9: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

1. [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π restart –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
2. [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
3. [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–æ—Ç–∞—Ü–∏—é –ª–æ–≥–æ–≤

---

## üõ† –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:
```bash
ssh user@your-vps-ip -p 22
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker:
```bash
docker --version
docker-compose --version
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤:
```bash
sudo netstat -tulpn | grep LISTEN
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:
```bash
docker logs -f <container_name>
```

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```bash
docker exec -it ai_image_bot_backend_prod alembic upgrade head
```

### Backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```bash
docker exec -it ai_image_bot_postgres_prod pg_dump -U postgres ai_image_bot > backup.sql
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   - –•—Ä–∞–Ω–∏—Ç–µ `.env` —Ñ–∞–π–ª –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ Git
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ firewall

2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
   - –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ RAM –∏ CPU
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–æ—Ç–∞—Ü–∏–µ–π
   - –†–µ–≥—É–ª—è—Ä–Ω–æ –¥–µ–ª–∞–π—Ç–µ backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –ü—Ä–∏ —Ä–æ—Å—Ç–µ –Ω–∞–≥—Ä—É–∑–∫–∏ —É–≤–µ–ª–∏—á—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ Celery workers
   - –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CDN –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Redis persistence

---

## üìû –ì–æ—Ç–æ–≤—ã –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é?

–ü–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ–∫-–ª–∏—Å—Ç–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ SSH –¥–æ—Å—Ç—É–ø:
- IP –∞–¥—Ä–µ—Å VPS
- –ü–æ—Ä—Ç SSH (–æ–±—ã—á–Ω–æ 22)
- –õ–æ–≥–∏–Ω
- –ü–∞—Ä–æ–ª—å –∏–ª–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á
- URL Portainer (–µ—Å–ª–∏ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ)

–Ø –ø–æ–º–æ–≥—É –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ —à–∞–≥–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è!
